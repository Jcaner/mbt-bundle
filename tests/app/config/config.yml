framework:
    secret:          secret
    test:            ~
    router:          { resource: '%kernel.project_dir%/config/routing.yml' }
    messenger:
        transports:
            filesystem: "filesystem://%kernel.cache_dir%/queue"
        routing:
            '*': filesystem

doctrine:
    dbal:
        driver:      pdo_sqlite
        path:        "%kernel.cache_dir%/test.db"
    orm:
        auto_mapping: true

services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

    App\:
        resource: '../src/*'
        exclude: '../src/{AppKernel.php}'

    Pnz\Messenger\FilesystemTransport\FilesystemTransportFactory:
        arguments:
            $encoder: '@messenger.transport.encoder'
            $decoder: '@messenger.transport.decoder'
            # Both the "filesystem" and "lock.factory" services can be auto-wired by Symfony
            $filesystem: '@filesystem'
            $lockFactory: '@lock.factory'
        # Configure the tags: this enables the `filesystem://` transport to be auto-discovered
        tags: ['messenger.transport_factory']

    Tienvx\Bundle\MbtBundle\Command\ReportBugCommand:
        arguments:
            $entityManager: '@doctrine.orm.entity_manager'
            $logger: '@monolog.logger.mbt'

security:
    providers:
        in_memory: { memory: ~ }
    firewalls:
        main:
            anonymous: ~

monolog:
    channels: ['mbt']
    handlers:
        file:
            type: stream
            path: "%kernel.logs_dir%/%kernel.environment%.log"
            level: error
            formatter: mbt.bug_formatter
            content_type: text/html
            channels: [mbt]

maker:
    root_namespace: 'App'

tienvx_mbt:
    generator:
        max_path_length: 300
        transition_coverage: 100
        place_coverage: 100
    command:
        default_bug_title: 'New bug found'
    subjects:
        shopping_cart: App\Subject\ShoppingCart
        checkout: App\Subject\Checkout
