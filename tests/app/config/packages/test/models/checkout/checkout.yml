framework:
    workflows:
        # https://demo.opencart.com
        checkout:
            type: 'workflow'
            supports:
                - Tienvx\Bundle\MbtBundle\Subject\Subject
            metadata:
                label: "Checkout"
                tags: ["opencart's checkout process", "demo", "workflow", "testing", "model-based-testing"]
            places:
                - home
                - awaitingAccount
                - awaitingBillingAddress
                - awaitingDeliveryAddress
                - awaitingDeliveryMethod
                - awaitingPaymentMethod
                - accountAdded
                - billingAddressAdded
                - deliveryAddressAdded
                - deliveryMethodAdded
                - paymentMethodAdded
                - orderPlaced
            initial_place: home
            transitions:
                addProductAndCheckoutNotLoggedIn:
                    from: home
                    to: awaitingAccount
                    guard: "!subject.loggedIn()"
                    metadata:
                        label: "Add product and go to checkout (not logged in)"
                addProductAndCheckoutLoggedIn:
                    from: home
                    to:
                        - accountAdded
                        - awaitingBillingAddress
                        - awaitingDeliveryAddress
                        - awaitingDeliveryMethod
                        - awaitingPaymentMethod
                    guard: "subject.loggedIn()"
                    metadata:
                        label: "Add product and go to checkout (logged in)"
                login:
                    from: awaitingAccount
                    to:
                        - accountAdded
                        - awaitingBillingAddress
                        - awaitingDeliveryAddress
                        - awaitingDeliveryMethod
                        - awaitingPaymentMethod
                    guard: "!subject.loggedIn()"
                    metadata:
                        weight: 33
                        label: "Login"
                guestCheckout:
                    from: awaitingAccount
                    to:
                        - accountAdded
                        - awaitingBillingAddress
                        - awaitingDeliveryAddress
                        - awaitingDeliveryMethod
                        - awaitingPaymentMethod
                    guard: "!subject.loggedIn()"
                    metadata:
                        weight: 33
                        label: "Guest Checkout"
                registerAccount:
                    from: awaitingAccount
                    to:
                        - accountAdded
                        - awaitingBillingAddress
                        - awaitingDeliveryAddress
                        - awaitingDeliveryMethod
                        - awaitingPaymentMethod
                    guard: "!subject.loggedIn()"
                    metadata:
                        weight: 33
                        label: "Register Account"
                addBillingAddress:
                    from: awaitingBillingAddress
                    to: billingAddressAdded
                    metadata:
                        label: "Add billing address"
                addDeliveryAddress:
                    from: awaitingDeliveryAddress
                    to: deliveryAddressAdded
                    metadata:
                        label: "Add delivery address"
                addDeliveryMethod:
                    from: awaitingDeliveryMethod
                    to: deliveryMethodAdded
                    metadata:
                        label: "Add delivery method"
                addPaymentMethod:
                    from: awaitingPaymentMethod
                    to: paymentMethodAdded
                    metadata:
                        label: "Add payment method"
                confirmOrder:
                    from:
                        - accountAdded
                        - billingAddressAdded
                        - deliveryAddressAdded
                        - deliveryMethodAdded
                        - paymentMethodAdded
                    to: orderPlaced
                    metadata:
                        label: "Confirm order"
                continueShopping:
                    from: orderPlaced
                    to: home
                    metadata:
                        label: "Continue shopping"
